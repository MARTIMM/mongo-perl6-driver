<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1136px" preserveAspectRatio="none" style="width:1097px;height:1136px;" version="1.1" viewBox="0 0 1097 1136" width="1097px" zoomAndPan="magnify"><defs><filter height="300%" id="f1b8nr9nfjeujy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193" x="458.5" y="22.9951">Client Server interaction</text><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="172.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="160" y="147.5938"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="101.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="160" y="944.0469"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="566.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="285" y="233.9922"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="283.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="423" y="771.25"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="349.5234"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="204.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="466.0547"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="413.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="691" y="640.8516"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="781" y="378.6563"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="781" y="495.1875"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="530.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="906" y="524.3203"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="928.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1065" y="126.5938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="48" x2="48" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="164.5" x2="164.5" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="289.5" x2="289.5" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="427.5" x2="427.5" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="558" x2="558" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="695.5" x2="695.5" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="786" x2="786" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="910.5" x2="910.5" y1="116.5938" y2="1063.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1070" x2="1070" y1="116.5938" y2="1063.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="8" y="113.292">application</text><ellipse cx="48" cy="43.2969" fill="#FEFECE" filter="url(#f1b8nr9nfjeujy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M48,51.2969 L48,78.2969 M35,59.2969 L61,59.2969 M48,78.2969 L35,93.2969 M48,78.2969 L61,93.2969 " fill="#FEFECE" filter="url(#f1b8nr9nfjeujy)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1b8nr9nfjeujy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="136.5" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="143.5" y="101.292">Client</text><rect fill="#A0FEFE" filter="url(#f1b8nr9nfjeujy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="250.5" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="257.5" y="101.292">Client T0</text><rect fill="#FEA0FE" filter="url(#f1b8nr9nfjeujy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="388.5" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="395.5" y="101.292">Client T1</text><rect fill="#A0FEFE" filter="url(#f1b8nr9nfjeujy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="527" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="534" y="101.292">Server</text><rect fill="#A0FEA0" filter="url(#f1b8nr9nfjeujy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="658.5" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="665.5" y="101.292">Server T</text><rect fill="#A0FEFE" filter="url(#f1b8nr9nfjeujy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="751" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="758" y="101.292">Monitor</text><rect fill="#C0C0C0" filter="url(#f1b8nr9nfjeujy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="869.5" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="876.5" y="101.292">Monitor T</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="1038" y="113.292">mongod</text><path d="M1052,64.2969 C1052,54.2969 1070,54.2969 1070,54.2969 C1070,54.2969 1088,54.2969 1088,64.2969 L1088,90.2969 C1088,100.2969 1070,100.2969 1070,100.2969 C1070,100.2969 1052,100.2969 1052,90.2969 L1052,64.2969 " fill="#FEFECE" filter="url(#f1b8nr9nfjeujy)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1052,64.2969 C1052,74.2969 1070,74.2969 1070,74.2969 C1070,74.2969 1088,74.2969 1088,64.2969 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="172.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="160" y="147.5938"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="101.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="160" y="944.0469"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="566.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="285" y="233.9922"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="283.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="423" y="771.25"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="349.5234"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="204.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="466.0547"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="413.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="691" y="640.8516"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="781" y="378.6563"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="781" y="495.1875"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="530.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="906" y="524.3203"/><rect fill="#FFFFFF" filter="url(#f1b8nr9nfjeujy)" height="928.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1065" y="126.5938"/><polygon fill="#A80036" points="148,143.5938,158,147.5938,148,151.5938,152,147.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="154" y1="147.5938" y2="147.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="55" y="142.6606">new(uri)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="170" x2="212" y1="191.9922" y2="191.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="212" y1="191.9922" y2="204.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="212" y1="204.9922" y2="204.9922"/><polygon fill="#A80036" points="181,200.9922,171,204.9922,181,208.9922,177,204.9922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="177" y="171.7935">store server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="177" y="186.9263">port in todo list</text><polygon fill="#A80036" points="273,229.9922,283,233.9922,273,237.9922,277,233.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="170" x2="279" y1="233.9922" y2="233.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="177" y="229.0591">Promise.start()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="295" x2="337" y1="278.3906" y2="278.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337" x2="337" y1="278.3906" y2="291.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="296" x2="337" y1="291.3906" y2="291.3906"/><polygon fill="#A80036" points="306,287.3906,296,291.3906,306,295.3906,302,291.3906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="302" y="258.1919">load server:port</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="302" y="273.3247">from todo list</text><polygon fill="#A80036" points="59,316.3906,49,320.3906,59,324.3906,55,320.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53" x2="164" y1="320.3906" y2="320.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="65" y="315.4575">Client object</text><polygon fill="#A80036" points="541,345.5234,551,349.5234,541,353.5234,545,349.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="295" x2="547" y1="349.5234" y2="349.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="302" y="344.5903">new()</text><polygon fill="#A80036" points="769,374.6563,779,378.6563,769,382.6563,773,378.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="775" y1="378.6563" y2="378.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="570" y="373.7231">new()</text><polygon fill="#A80036" points="574,403.7891,564,407.7891,574,411.7891,570,407.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="568" x2="785" y1="407.7891" y2="407.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="580" y="402.856">Monitor object</text><polygon fill="#A80036" points="306,432.9219,296,436.9219,306,440.9219,302,436.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="300" x2="557" y1="436.9219" y2="436.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="312" y="431.9888">Server object</text><polygon fill="#A80036" points="541,462.0547,551,466.0547,541,470.0547,545,466.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="295" x2="547" y1="466.0547" y2="466.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="302" y="461.1216">server-init()</text><polygon fill="#A80036" points="769,491.1875,779,495.1875,769,499.1875,773,495.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="775" y1="495.1875" y2="495.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="570" y="490.2544">start-monitor()</text><polygon fill="#A80036" points="894,520.3203,904,524.3203,894,528.3203,898,524.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="791" x2="900" y1="524.3203" y2="524.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="798" y="519.3872">Promise.start()</text><polygon fill="#A80036" points="574,549.4531,564,553.4531,574,557.4531,570,553.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="568" x2="785" y1="553.4531" y2="553.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="580" y="548.52">Promise</text><polygon fill="#A000BF" points="1053,578.5859,1063,582.5859,1053,586.5859,1057,582.5859" style="stroke: #A000BF; stroke-width: 1.0;"/><line style="stroke: #A000BF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="916" x2="1059" y1="582.5859" y2="582.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="923" y="577.6528">ismaster command</text><polygon fill="#A000BF" points="927,607.7188,917,611.7188,927,615.7188,923,611.7188" style="stroke: #A000BF; stroke-width: 1.0;"/><line style="stroke: #A000BF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="921" x2="1064" y1="611.7188" y2="611.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="933" y="606.7856">ismaster result</text><polygon fill="#A80036" points="679,636.8516,689,640.8516,679,644.8516,683,640.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="685" y1="640.8516" y2="640.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="570" y="635.9185">tap from monitor</text><ellipse cx="700.5" cy="699.2344" fill="none" rx="4" ry="4" style="stroke: #A000BF; stroke-width: 1.5;"/><polygon fill="#A000BF" points="717.5,695.9844,707.5,699.9844,717.5,703.9844,713.5,699.9844" style="stroke: #A000BF; stroke-width: 1.0;"/><ellipse cx="905.5" cy="699.2344" fill="none" rx="4" ry="4" style="stroke: #A000BF; stroke-width: 1.5;"/><line style="stroke: #A000BF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="715.5" x2="901" y1="699.9844" y2="699.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="718" y="695.0513">monitor data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="701" x2="743" y1="729.25" y2="729.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="743" x2="743" y1="729.25" y2="742.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="702" x2="743" y1="742.25" y2="742.25"/><polygon fill="#A80036" points="712,738.25,702,742.25,712,746.25,708,742.25" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="708" y="724.1841">Set status</text><polygon fill="#A80036" points="411,767.25,421,771.25,411,775.25,415,771.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="295" x2="417" y1="771.25" y2="771.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="302" y="766.3169">tap from monitor</text><ellipse cx="432.5" cy="799.6328" fill="none" rx="4" ry="4" style="stroke: #A000BF; stroke-width: 1.5;"/><polygon fill="#A000BF" points="449.5,796.3828,439.5,800.3828,449.5,804.3828,445.5,800.3828" style="stroke: #A000BF; stroke-width: 1.0;"/><ellipse cx="905.5" cy="799.6328" fill="none" rx="4" ry="4" style="stroke: #A000BF; stroke-width: 1.5;"/><line style="stroke: #A000BF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="447.5" x2="901" y1="800.3828" y2="800.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="450" y="795.4497">monitor data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="433" x2="475" y1="844.7813" y2="844.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="475" x2="475" y1="844.7813" y2="857.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="475" y1="857.7813" y2="857.7813"/><polygon fill="#A80036" points="444,853.7813,434,857.7813,444,861.7813,440,857.7813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="440" y="824.5825">store new server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="440" y="839.7153">data in todo list</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="433" x2="475" y1="902.0469" y2="902.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="475" x2="475" y1="902.0469" y2="915.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="475" y1="915.0469" y2="915.0469"/><polygon fill="#A80036" points="444,911.0469,434,915.0469,444,919.0469,440,915.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="440" y="881.8481">Store in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="440" y="896.981">server list</text><polygon fill="#A80036" points="148,940.0469,158,944.0469,148,948.0469,152,944.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="154" y1="944.0469" y2="944.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="55" y="939.1138">select-server()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="170" x2="212" y1="1003.5781" y2="1003.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="212" y1="1003.5781" y2="1016.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="212" y1="1016.5781" y2="1016.5781"/><polygon fill="#A80036" points="181,1012.5781,171,1016.5781,181,1020.5781,177,1016.5781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="177" y="968.2466">Get server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="177" y="983.3794">from server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="177" y="998.5122">list</text><polygon fill="#A80036" points="59,1041.5781,49,1045.5781,59,1049.5781,55,1045.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53" x2="164" y1="1045.5781" y2="1045.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="65" y="1040.645">Server object</text><rect fill="#DDDDDD" height="42.5938" rx="5" ry="5" style="stroke: #000000; stroke-width: 1.0;" width="522" x="293.5" y="1093.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="380" x="299.5" y="1111.0029">Monitor data is sent from Monitor thread using a Supply</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="510" x="299.5" y="1127.2998">Data in Client structures for communication are guarded with Semaphores</text><!--
@startuml

title Client Server interaction
hide footbox

actor application as app
participant Client
participant "Client T0" as Clt0 #a0fefe
participant "Client T1" as Clt1 #fea0fe
participant Server              #a0fefe
participant "Server T" as Srvt0 #a0fea0
participant Monitor             #a0fefe
participant "Monitor T" as Mnt0 #c0c0c0
database mongod
activate mongod

app -> Client: new(uri)
activate Client

'Todo list is a structure guarded by semaphores
Client -> Client: store server\nport in todo list

Client -> Clt0: Promise.start()
activate Clt0

Clt0 -> Clt0: load server:port\nfrom todo list

Client -> app: Client object
deactivate Client

Clt0 -> Server: new()
activate Server
Server -> Monitor: new()
activate Monitor
Monitor -> Server: Monitor object
deactivate Monitor
Server -> Clt0: Server object
deactivate Server


Clt0 -> Server: server-init()
activate Server
Server -> Monitor: start-monitor()
activate Monitor
Monitor -> Mnt0: Promise.start()
activate Mnt0
Monitor -> Server: Promise
deactivate Monitor

Mnt0 -[#a000bf]-> mongod: ismaster command
mongod -[#a000bf]-> Mnt0: ismaster result
Server -> Srvt0: tap from monitor
activate Srvt0
deactivate Server

Mnt0 o-[#a000bf]->o Srvt0: monitor data
'activate Srvt0
Srvt0 -> Srvt0: Set status
'deactivate Srvt0


Clt0 -> Clt1: tap from monitor
activate Clt1
Mnt0 o-[#a000bf]->o Clt1: monitor data
deactivate Clt0

Clt1 -> Clt1: store new server\ndata in todo list

Clt1 -> Clt1: Store in\nserver list

'note right: in thread
'note right: returns immediate
'Server - -> mongod: connect



app -> Client: select-server()
activate Client
Client -> Client: Get server\nfrom server\nlist
Client -> app: Server object
deactivate Client

legend
Monitor data is sent from Monitor thread using a Supply
Data in Client structures for communication are guarded with Semaphores
end legend

@enduml

PlantUML version 1.2017.12(Wed Apr 26 18:06:36 CEST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_131-b12
Operating System: Linux
OS Version: 4.10.11-100.fc24.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>