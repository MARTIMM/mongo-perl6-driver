@startuml

title Client Server interaction
hide footbox

actor application as app
participant Client
participant Server
database mongod

app -> Client: uri
activate Client

Client -> Server: create
activate Server
note right: in thread

Client -> app:
note right: returns immediate
deactivate Client

Server --> mongod: connect

app -> Client: select-server()
activate Client

Client -> Client: cleanup-promises()
activate Client

Server -> Client: Server object
deactivate Server

Client -> Client: acceptence tests
activate Client
deactivate Client

Client -> Server: _monitor-server()
activate Server
note right: infinite loop in thread

Server -> mongod: ismaster command
mongod -> Server: ismaster result
deactivate Client

Client -> Client: server data processing
activate Client
Server -> Client: server data
note right: through channel
deactivate Client


Client -> app: Server object
deactivate Client

@enduml
