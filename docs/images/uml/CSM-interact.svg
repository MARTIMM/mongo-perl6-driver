<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1618px" preserveAspectRatio="none" style="width:896px;height:1618px;" version="1.1" viewBox="0 0 896 1618" width="896px" zoomAndPan="magnify"><defs><filter height="300%" id="f10clnjo396006" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#EFFFFF" height="1606.4761" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.0;" width="78" x="473.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="492" y="18.0669">never</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="487" y="33.1997">ending</text><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="393.5796" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="106.9194"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="246.8574" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="621.4619"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1001.2822"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1060.5229"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1119.7637"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="342.9258" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1222.1372"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="94.6538" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="250.5" y="319.123"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="459.3018" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="250.5" y="571.9805"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="130.7222" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="250.5" y="1251.3779"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="94.6538" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331.5" y="723.1841"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="190.3425" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331.5" y="959.4211"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="130.7222" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331.5" y="1411.3408"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="507.5" y="136.1602"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="1363.1621" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="507.5" y="201.9009"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="249.8823"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="354.5361"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="758.5972"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="1280.6187"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="1440.5815"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="97.5" x2="97.5" y1="75.6787" y2="1574.063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="255" x2="255" y1="320.5889" y2="1574.063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="336" x2="336" y1="724.6499" y2="1574.063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="512.5" x2="512.5" y1="75.6787" y2="1574.063"/><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="69.5" y="40.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="76.5" y="60.3496">Client</text><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="69.5" y="1573.063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="76.5" y="1593.147">Client</text><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="220" y="1573.063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="227" y="1593.147">Server1</text><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="301" y="1573.063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="308" y="1593.147">Server2</text><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="477.5" y="40.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="484.5" y="60.3496">Monitor</text><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="477.5" y="1573.063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="484.5" y="1593.147">Monitor</text><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="393.5796" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="106.9194"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="246.8574" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="621.4619"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1001.2822"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1060.5229"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1119.7637"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="342.9258" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="93" y="1222.1372"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="94.6538" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="250.5" y="319.123"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="459.3018" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="250.5" y="571.9805"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="130.7222" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="250.5" y="1251.3779"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="94.6538" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331.5" y="723.1841"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="190.3425" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331.5" y="959.4211"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="130.7222" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331.5" y="1411.3408"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="507.5" y="136.1602"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="1363.1621" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="507.5" y="201.9009"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="249.8823"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="354.5361"/><rect fill="#A9DCDF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="758.5972"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="1280.6187"/><rect fill="#FFFFFF" filter="url(#f10clnjo396006)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="512.5" y="1440.5815"/><polygon fill="#A80036" points="81,102.9194,91,106.9194,81,110.9194,85,106.9194" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="0" x2="87" y1="106.9194" y2="106.9194"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="7" y="101.8281">.new(:uri)</text><polygon fill="#A80036" points="495.5,132.1602,505.5,136.1602,495.5,140.1602,499.5,136.1602" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="501.5" y1="136.1602" y2="136.1602"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="110" y="131.0688">.instance()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="512.5" x2="559.5" y1="188.9009" y2="188.9009"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="559.5" x2="559.5" y1="188.9009" y2="201.9009"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="518.5" x2="559.5" y1="201.9009" y2="201.9009"/><polygon fill="#A80036" points="528.5,197.9009,518.5,201.9009,528.5,205.9009,524.5,201.9009" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M567,184.1602 L567,214.1602 A5,5 0 0 0 572,219.1602 L870,219.1602 A5,5 0 0 0 875,214.1602 L875,189.1602 L865,179.1602 L572,179.1602 A5,5 0 0 0 567,184.1602 " fill="#FBFB77" filter="url(#f10clnjo396006)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M865,179.1602 L865,186.6602 A2.5,2.5 0 0 0 867.5,189.1602 L875,189.1602 L865,179.1602 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="573" y="196.3096">Monitor started in thread and runs for all</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="287" x="573" y="211.5503">servers. Monitor ends when application ends.</text><polygon fill="#A80036" points="500.5,245.8823,510.5,249.8823,500.5,253.8823,504.5,249.8823" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="103" x2="506.5" y1="249.8823" y2="249.8823"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="110" y="244.791">emit heartbeatfrequency</text><polygon fill="#A80036" points="208,305.123,218,309.123,208,313.123,212,309.123" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="214" y1="309.123" y2="309.123"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="110" y="304.0317">Server.new(...)</text><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="220" y="287.8823"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="227" y="307.9663">Server1</text><polygon fill="#A80036" points="500.5,350.5361,510.5,354.5361,500.5,358.5361,504.5,354.5361" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="260.5" x2="506.5" y1="354.5361" y2="354.5361"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="267.5" y="349.4448">emit register server</text><polygon fill="#A80036" points="114,409.7769,104,413.7769,114,417.7769,110,413.7769" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="254.5" y1="413.7769" y2="413.7769"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="120" y="408.6855">srv1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="145" y1="458.2583" y2="458.2583"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="145" x2="145" y1="458.2583" y2="471.2583"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="145" y1="471.2583" y2="471.2583"/><polygon fill="#A80036" points="114,467.2583,104,471.2583,114,475.2583,110,471.2583" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="110" y="437.9263">add server srv1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="110" y="453.167">to serverpool</text><polygon fill="#A80036" points="11,496.499,1,500.499,11,504.499,7,500.499" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="5" x2="97" y1="500.499" y2="500.499"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="17" y="495.4077">cl</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="517.5" x2="559.5" y1="529.7397" y2="529.7397"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="559.5" x2="559.5" y1="529.7397" y2="542.7397"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="518.5" x2="559.5" y1="542.7397" y2="542.7397"/><polygon fill="#A80036" points="528.5,538.7397,518.5,542.7397,528.5,546.7397,524.5,542.7397" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="524.5" y="524.6484">get server info</text><polygon fill="#A80036" points="271.5,567.9805,261.5,571.9805,271.5,575.9805,267.5,571.9805" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="265.5" x2="506.5" y1="571.9805" y2="571.9805"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="277.5" y="566.8892">emit server info</text><polygon fill="#A80036" points="114,617.4619,104,621.4619,114,625.4619,110,621.4619" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="249.5" y1="621.4619" y2="621.4619"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="120" y="616.3706">emit add servers</text><path d="M265,589.9805 L265,634.9805 A5,5 0 0 0 270,639.9805 L464,639.9805 A5,5 0 0 0 469,634.9805 L469,594.9805 L459,584.9805 L270,584.9805 A5,5 0 0 0 265,589.9805 " fill="#FBFB77" filter="url(#f10clnjo396006)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M459,584.9805 L459,592.4805 A2.5,2.5 0 0 0 461.5,594.9805 L469,594.9805 L459,584.9805 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="271" y="602.1299">Servers can get other server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="271" y="617.3706">names from the returned</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="271" y="632.6113">server info</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="145" y1="670.9434" y2="670.9434"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="145" x2="145" y1="670.9434" y2="683.9434"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="145" y1="683.9434" y2="683.9434"/><polygon fill="#A80036" points="114,679.9434,104,683.9434,114,687.9434,110,683.9434" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="110" y="665.8521">check new server</text><polygon fill="#A80036" points="289,709.1841,299,713.1841,289,717.1841,293,713.1841" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="295" y1="713.1841" y2="713.1841"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="110" y="708.0928">Server.new(...)</text><rect fill="#FEFECE" filter="url(#f10clnjo396006)" height="30.4131" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="301" y="691.9434"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="308" y="712.0273">Server2</text><polygon fill="#A80036" points="500.5,754.5972,510.5,758.5972,500.5,762.5972,504.5,758.5972" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341.5" x2="506.5" y1="758.5972" y2="758.5972"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="348.5" y="753.5059">emit register server</text><polygon fill="#A80036" points="114,813.8379,104,817.8379,114,821.8379,110,817.8379" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="335.5" y1="817.8379" y2="817.8379"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="120" y="812.7466">srv2</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="145" y1="867.3193" y2="867.3193"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="145" x2="145" y1="867.3193" y2="880.3193"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="98" x2="145" y1="880.3193" y2="880.3193"/><polygon fill="#A80036" points="108,876.3193,98,880.3193,108,884.3193,104,880.3193" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="110" y="846.9873">add server srv2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="110" y="862.228">to serverpool</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="517.5" x2="559.5" y1="904.5601" y2="904.5601"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="559.5" x2="559.5" y1="904.5601" y2="917.5601"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="518.5" x2="559.5" y1="917.5601" y2="917.5601"/><polygon fill="#A80036" points="528.5,913.5601,518.5,917.5601,528.5,921.5601,524.5,917.5601" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="524.5" y="899.4688">get server info</text><polygon fill="#A80036" points="352.5,955.4211,342.5,959.4211,352.5,963.4211,348.5,959.4211" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="346.5" x2="506.5" y1="959.4211" y2="959.4211"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="358.5" y="954.3298">emit server info</text><path d="M522,935.5601 L522,965.5601 A5,5 0 0 0 527,970.5601 L712,970.5601 A5,5 0 0 0 717,965.5601 L717,940.5601 L707,930.5601 L527,930.5601 A5,5 0 0 0 522,935.5601 " fill="#FBFB77" filter="url(#f10clnjo396006)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M707,930.5601 L707,938.0601 A2.5,2.5 0 0 0 709.5,940.5601 L717,940.5601 L707,930.5601 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="528" y="947.7095">Server2 acts like server1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="528" y="962.9502">only shown here for thread.</text><polygon fill="#A80036" points="114,997.2822,104,1001.2822,114,1005.2822,110,1001.2822" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="249.5" y1="1001.2822" y2="1001.2822"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="120" y="996.1909">emit server state</text><polygon fill="#A80036" points="114,1056.5229,104,1060.5229,114,1064.5229,110,1060.5229" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="330.5" y1="1060.5229" y2="1060.5229"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="120" y="1055.4316">emit add servers</text><polygon fill="#A80036" points="114,1115.7637,104,1119.7637,114,1123.7637,110,1119.7637" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="330.5" y1="1119.7637" y2="1119.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="120" y="1114.6724">emit server state</text><rect fill="#EEEEEE" filter="url(#f10clnjo396006)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="889.5" x="0" y="1178.3301"/><line style="stroke: #000000; stroke-width: 1.0;" x1="0" x2="889.5" y1="1178.3301" y2="1178.3301"/><line style="stroke: #000000; stroke-width: 1.0;" x1="0" x2="889.5" y1="1181.3301" y2="1181.3301"/><rect fill="#EEEEEE" filter="url(#f10clnjo396006)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="225" x="332.25" y="1167.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="338.25" y="1183.8306">after some use of the client</text><polygon fill="#A80036" points="81,1218.1372,91,1222.1372,81,1226.1372,85,1222.1372" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="0" x2="87" y1="1222.1372" y2="1222.1372"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="7" y="1217.0459">cl.cleanup()</text><polygon fill="#A80036" points="238.5,1247.3779,248.5,1251.3779,238.5,1255.3779,242.5,1251.3779" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="244.5" y1="1251.3779" y2="1251.3779"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="110" y="1246.2866">.cleanup()</text><polygon fill="#A80036" points="500.5,1276.6187,510.5,1280.6187,500.5,1284.6187,504.5,1280.6187" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="260.5" x2="506.5" y1="1280.6187" y2="1280.6187"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="267.5" y="1275.5273">emit unregister server</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="260.5" x2="302.5" y1="1355.1001" y2="1355.1001"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302.5" x2="302.5" y1="1355.1001" y2="1368.1001"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="261.5" x2="302.5" y1="1368.1001" y2="1368.1001"/><polygon fill="#A80036" points="271.5,1364.1001,261.5,1368.1001,271.5,1372.1001,267.5,1368.1001" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="267.5" y="1334.7681">cleanup</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="267.5" y="1350.0088">sockets</text><polygon fill="#A80036" points="114,1378.1001,104,1382.1001,114,1386.1001,110,1382.1001" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="254.5" y1="1382.1001" y2="1382.1001"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="246.5" x2="264.5" y1="1373.1001" y2="1391.1001"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="246.5" x2="264.5" y1="1391.1001" y2="1373.1001"/><polygon fill="#A80036" points="319.5,1407.3408,329.5,1411.3408,319.5,1415.3408,323.5,1411.3408" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="103" x2="325.5" y1="1411.3408" y2="1411.3408"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="110" y="1406.2495">.cleanup()</text><polygon fill="#A80036" points="500.5,1436.5815,510.5,1440.5815,500.5,1444.5815,504.5,1440.5815" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341.5" x2="506.5" y1="1440.5815" y2="1440.5815"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="348.5" y="1435.4902">emit unregister server</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="341.5" x2="383.5" y1="1515.063" y2="1515.063"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="383.5" x2="383.5" y1="1515.063" y2="1528.063"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="383.5" y1="1528.063" y2="1528.063"/><polygon fill="#A80036" points="352.5,1524.063,342.5,1528.063,352.5,1532.063,348.5,1528.063" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="348.5" y="1494.731">cleanup</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="348.5" y="1509.9717">sockets</text><polygon fill="#A80036" points="114,1538.063,104,1542.063,114,1546.063,110,1542.063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="108" x2="335.5" y1="1542.063" y2="1542.063"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="327.5" x2="345.5" y1="1533.063" y2="1551.063"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="327.5" x2="345.5" y1="1551.063" y2="1533.063"/><polygon fill="#A80036" points="11,1552.063,1,1556.063,11,1560.063,7,1556.063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="5" x2="92" y1="1556.063" y2="1556.063"/><!--MD5=[157c461f678704526914c7ab8b5a24fe]
@startuml


skinparam roundcorner 10
skinparam sequence {
'  LifeLineBorderColor blue
  LifeLineBackgroundColor #fff
}

participant Client
participant Server1
participant Server2
participant Monitor

-> Client ++: .new(:uri)

box "never\nending" #efffff
  participant Monitor
end box

Client -> Monitor ++: .instance()
deactivate Monitor
Monitor -> Monitor ++ #A9DCDF:
note right
  Monitor started in thread and runs for all
  servers. Monitor ends when application ends.
end note

Client - -> Monitor ++ : emit heartbeatfrequency
deactivate Monitor

create Server1
Client -> Server1 ++: Server.new(...)
Server1 - -> Monitor ++: emit register server
deactivate Monitor
return srv1
Client -> Client: add server srv1 \nto serverpool

<- - Client: cl
deactivate Client

Monitor -> Monitor: get server info
Monitor - -> Server1 ++ #A9DCDF: emit server info

Server1 - -> Client ++ #A9DCDF: emit add servers
  note right
    Servers can get other server
    names from the returned
    server info
  end note

  Client -> Client: check new server
  create Server2
  Client -> Server2 ++ #A9DCDF: Server.new(...)
  Server2 - -> Monitor ++ #A9DCDF: emit register server
  deactivate Monitor
  return srv2
  Client -> Client: add server srv2\nto serverpool
  deactivate Client

  Monitor -> Monitor: get server info

  Monitor - -> Server2 ++ #A9DCDF: emit server info
  note right
    Server2 acts like server1
    only shown here for thread.
  end note


Server1 - -> Client ++ #A9DCDF: emit server state
deactivate Client
deactivate Server1

Server2 - -> Client ++ #A9DCDF: emit add servers

deactivate Client
Server2 - -> Client ++ #A9DCDF: emit server state
deactivate Client
deactivate Server2

== after some use of the client ==

-> Client ++: cl.cleanup()
Client -> Server1++: .cleanup()
Server1 - -> Monitor ++: emit unregister server
deactivate Monitor

Server1 -> Server1: cleanup\nsockets
Server1 - -> Client:
destroy Server1

Client -> Server2 ++: .cleanup()
Server2 - -> Monitor ++: emit unregister server
deactivate Monitor

Server2 -> Server2: cleanup\nsockets
Server2 - -> Client:

deactivate Server2
destroy Server2

<- - Client:

@enduml

@startuml


skinparam roundcorner 10
skinparam sequence {
  LifeLineBackgroundColor #fff
}

participant Client
participant Server1
participant Server2
participant Monitor

-> Client ++: .new(:uri)

box "never\nending" #efffff
  participant Monitor
end box

Client -> Monitor ++: .instance()
deactivate Monitor
Monitor -> Monitor ++ #A9DCDF:
note right
  Monitor started in thread and runs for all
  servers. Monitor ends when application ends.
end note

Client - -> Monitor ++ : emit heartbeatfrequency
deactivate Monitor

create Server1
Client -> Server1 ++: Server.new(...)
Server1 - -> Monitor ++: emit register server
deactivate Monitor
return srv1
Client -> Client: add server srv1 \nto serverpool

<- - Client: cl
deactivate Client

Monitor -> Monitor: get server info
Monitor - -> Server1 ++ #A9DCDF: emit server info

Server1 - -> Client ++ #A9DCDF: emit add servers
  note right
    Servers can get other server
    names from the returned
    server info
  end note

  Client -> Client: check new server
  create Server2
  Client -> Server2 ++ #A9DCDF: Server.new(...)
  Server2 - -> Monitor ++ #A9DCDF: emit register server
  deactivate Monitor
  return srv2
  Client -> Client: add server srv2\nto serverpool
  deactivate Client

  Monitor -> Monitor: get server info

  Monitor - -> Server2 ++ #A9DCDF: emit server info
  note right
    Server2 acts like server1
    only shown here for thread.
  end note


Server1 - -> Client ++ #A9DCDF: emit server state
deactivate Client
deactivate Server1

Server2 - -> Client ++ #A9DCDF: emit add servers

deactivate Client
Server2 - -> Client ++ #A9DCDF: emit server state
deactivate Client
deactivate Server2

== after some use of the client ==

-> Client ++: cl.cleanup()
Client -> Server1++: .cleanup()
Server1 - -> Monitor ++: emit unregister server
deactivate Monitor

Server1 -> Server1: cleanup\nsockets
Server1 - -> Client:
destroy Server1

Client -> Server2 ++: .cleanup()
Server2 - -> Monitor ++: emit unregister server
deactivate Monitor

Server2 -> Server2: cleanup\nsockets
Server2 - -> Client:

deactivate Server2
destroy Server2

<- - Client:

@enduml

PlantUML version 1.2020.19(Mon Oct 12 17:10:01 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>